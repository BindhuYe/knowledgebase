# PostgreSQL vs Amazon RDS: Performance & Price

we'll compare postgres and Amazon RDS we'll look not at just performance like latency for Crow operations and saturation but also functionality and the price you'll have to pay so this video is mostly dedicated to helping you decide whether Amazon RDS is worth the price so what is Amazon RDS well it's not a database itself it's a set of tools designed to help you deploy maintain scale and even recover your database if there is outage essentially Amazon RDS is a managed service where

you pay to have your database maintained on your behalf it comes with API and you can use it via advs console or we often use terraform for provisioning Amazon RDS instances it supports multiple database engines like MySQL postgres SQL Server Oracle and db2 now why would you want to use use it first it's all about ease of management you don't need a devops team as a developer you can easily provision at database like POG grass and run it in production Amazon RDS can automatically increase the dis size for your database

when your amount of data grows it can also help you scale vertically by upgrading a database instance class to one with more CPU and memory or scale it horizontally by adding more read replicas it's all automated and only requires a few clicks or a single terraform apply command if you need High availability you can spread your replicas across multiple availability zones as well there is also a proxy that abstracts your replicas and it can even integrate with Amazon IM for access management to your database additionally

it handles backup and recovery for you and provides Magics out of the box like CP VI usage memory usage connection count and more the real question is how much it costs and is it worth it so let's take a look at how you pay for Amazon RDS first of all you pay for DB instance class for this Benchmark I used db. MH large class which in US is one region would cost you $125 per month it has two virtual CPUs and 8 GB of memory nowadays we frequently use graviton based instances for infrastructure components they just

more cost effective now let's say you decide to provision and maintain your database yourself using exactly the same m a large instance with the same number of CPUs and memory it would cost you $66 on average compute for the database would cost almost exactly twice as much as easy to instance that you would manage yourself next we have storage you would pay for disk usage how much space it takes and you additionally pay for the dis operations per second in this test I used cheapest gp3 storage class

on a small scale it's going to cost much less than the DB instance itself next is a data transfer charges here you need to be very careful RDS always says that high availability is highly recommended but if you deploy your Amazon RDS in the same availability Zone as your other applications it's going to be free if you deploy or create high availability Amazon RDS deployment across multiple availability zones adbs will charge you for the data transfer depending on your workload this can be very expensive and

sometimes can even be more expensive than compute resources you use for the database and applications it's very likely that you'll be just fine using a single availability Zone and not paying for the data transfer charges outages happen in RDS but not so frequently and just deploying a single database in multiple zones may not actually help and finally there are some additional features like extended monitoring snapshotting and exporting your data to S3 among others that you would need to pay extra for so on average RDS will

cost you twice as much as a self-managed database on easy to instance from my personal experience it's worth it and losing data for the company it's a nightmare there are a couple of times I might choose a self-hosted database maybe it's a staging or development environment where you don't really care if you lose data also you might have a large devops team and large infrastructure where it could be worth managing your database yourself but most of the time I would recommend using Amazon RDS all right let's go ahead and run the

test I've used mostly default settings for Amazon RDS and I've used PJ tune to optimize my selfhosted postgres so most of the differences you'll see in this test actually caused by this settings rather than anything else both Amazon RDS and my selfhosted postgres used the same compute instance class storage class and deployed in the same availability Zone as my eks cluster so there is no additional latency on the left hand side you'll see latency for insert update delete and select operations you can find the client

source code in my public GitHub repository which is instrumented internally with Prometheus on the right hand side we have queries per second CPU usage and disk R operations CPU and disk metrics exported from the RDS but unfortunately you'll notice that Amazon's Metrics log behind Prometheus you can adjust scrape intervals and to be honest it's only noticeable when you compare metrics from different sources like I'm doing for this Benchmark if you're just monitoring NBS services with cloudwatch Metrics

as expected performance of these two databases is almost identical so it's not really a deciding factor in choosing which database to use the main difference is cost in my opinion Amazon RDS is one of those managed services that I would strongly recommend especially if you don't have any experience managing and recovering databases in production which can be very challenging also if you think about deploying a database like postgres to kubernetes you're just waiting for a disaster to happen I have other

